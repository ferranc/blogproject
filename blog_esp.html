<html lang="en"><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="">
    <meta name="author" content="">


    <title>¿De qué hablan los políticos?</title>

    <!-- Bootstrap core CSS -->
    <link href="bootstrap/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="bootstrap/css/blog.css" rel="stylesheet">

    <!-- Just for debugging purposes. Don't actually copy these 2 lines! -->
    <!--[if lt IE 9]><script src="../../assets/js/ie8-responsive-file-warning.js"></script><![endif]-->
 
	<style>
	iframe {
		width:600px;
		height: 600px;
		}
	#borde { border: 2px black solid; }	
	</style>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>

   <div class="navbar-wrapper">
      <div class="container">

        <nav class="navbar navbar-inverse navbar-static-top">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="true" aria-controls="navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              <a class="navbar-brand">¿De qué hablan los políticos?</a>
            </div>
			<div id="navbar" class="navbar-collapse collapse">
              <ul class="nav navbar-nav">
				<li><a href="./index_esp.html">Página Principal</a></li>
				<li><a href="./el_radar.html">El Radar</a></li>
                <li><a href="./el_analisis.html">El Análisis</a></li>
				<li><a href="./lineas_politicas.html">Líneas Políticas</a></li>
				<li><a href="./que_dicen.html">¿Qué dicen?</a></li>
				<li class="active"><a>Blog</a></li>
              </ul>
            </div>
          </div>
        </nav>

      </div>
    </div>
  </head>
  
  <body>

    <div class="container">

      <div class="blog-header">
        <h1 class="blog-title">¿De qué hablan los políticos?</h1>
        <p class="lead blog-description">El proceso:¿Cómo lo hemos hecho?</p>
      </div>

      <div class="row">

        <div class="col-sm-8 blog-main">

          <div class="blog-post">
            <h2 class="blog-post-title">¿Cómo funciona el Barómetro del CIS?</h2>
			<p> <br>  Cada mes 2.500 españoles mayores de edad son seleccionados de forma aleatória proporcional teniendo en cuenta otras variables como sexo, edad, población o hábitat. Los seleccionados son entrevistados por los agentes del CIS personalmente en su casa. Es a partir de estas encuestas de donde se obtienen la información para los barómetros (<a href="http://www.cis.es/cis/export/sites/default/-Archivos/NotasdeInvestigacion/NI004_MetodologiaBarometros_Informe.pdf">más información sobre el método</a>).
				<br><br>  Estos estudios contienen un bloque de preguntas fijas y otro variable que está orientado a un tema de interés político o social según la ocasión. Dentro de este grupo de preguntas fijas nos centramos en las siguientes preguntas:
			 <blockquote><ul>
              <p><li>-¿Cuál es, a su juicio, el principal problema que existe actualmente en España?¿Y el segundo?¿Y el tercero?(RESPUESTA ESPONTÁNEA) - Desde mar'06</li></p>
				<img src="images/pregunta1_cis.png" alt="Pregunta CIS" width="750" height="250">
			    <p><li>-¿Cuáles son, a su juicio, los tres problemas principales que existen actualmente en España?(MÁXIMO TRES RESPUESTAS) - Desde sep'00 a feb'06</li></p>
				<img src="images/pregunta2_cis.png" alt="Pregunta CIS" width="700" height="400">
            </ul></blockquote>
			<p> Estas nos dan información sobre los 3 principales problemas que percibe la población española y son las que utilizaremos para saber que le preocupa.
			<br><br> Podemos consultar los resultados de los barómetros a lo largo del tiempo en el <a href="http://www.cis.es/cis/opencm/ES/11_barometros/depositados.jsp">banco de datos</a>.</p>
		</div><!-- /.blog-post -->

		<div class="blog-post">
            <h2 class="blog-post-title">¿Cómo funcionan las Sesiones de Control al Gobierno en el Congreso de los Diputados?</h2>
			<p><br>   Dentro de los diferentes tipos de sesiones que se realizan en el Congreso elegimos las sesiones de control al gobierno, que se celebran actualmente los miércoles. Aunque estas no están definidas en la constitución  ni por los reglamentos parlamentarios, se han consolidado con la práctica debido a que es en estas donde los diferentes partidos políticos explican sus inquietudes respecto a nuevas legislaciones o problemas a solucionar y el presidente del gobierno, junto con sus diferentes ministros, debe dar respuesta a ellas.
			<br><br> Los diarios de estas sesiones los encontramos en la web del congreso, 100% accesibles desde un <a href="http://www.congreso.es/portal/page/portal/Congreso/Congreso/Publicaciones"> buscador</a>. 
			<br><br> Podemos encontrar información sobre su funcionamiento en el siguiente <a href="http://www.periodistasparlamentarios.org/?p=834">documento</a>:</p>
			<blockquote>
			<p>"[...] Una sesión plenaria ordinaria dedica por regla general un mínimo de dos horas a debatir preguntas e interpelaciones. Estas sesiones de control se llevan a cabo los martes por la tarde en el Senado y los miércoles por la mañana en el Congreso.
			<br><br>En primer lugar se debaten las preguntas y, a continuación, las interpelaciones. La respuesta del Gobierno a estas últimas da lugar a una iniciativa del grupo interpelante que recoge las conclusiones de ese debate con el Ejecutivo y las convierte en propuestas (moción consecuencia de interpelación). Estas se debaten en la siguiente sesión plenaria. [...]"</p>
			</blockquote>
		</div>
		
		<div class="blog-post">
            <h2 class="blog-post-title">El Scrapping</h2>
			<p><br>  El Scrapping es el proceso por el cual extraemos los datos de una página web. En este caso hemos procesado los barómetros del CIS utilizando su banco de datos y los diarios del Congreso a través de su buscador.
				<br><br> Para esta parte del proceso han sido necesarios los paquetes: Selenium y BeautifulSoup.</p>
			<h3> <br>CIS </h3>
			<p> Hemos utilizado Selenium para descargar los diferentes Barómetros y BeautifulSoup para extraer la información de las preguntas que nos interesaban. Para su posterior tratamiento lo hemos guardado en una base de datos en MongoDB</p>
			<p><br>Como respuesta a cada pregunta obtenemos 30 tópicos diferentes, por lo que a lo largo de todo el periodo en el que hemos generado datos (desde sept.'00 hasta feb. '15) hemos encontrado alrededor de 150 tópicos diferentes. Debido a la imposibilidad de visualizar tal cantidad de tópicos y que muchos de ellos eran similares decidimos agruparlos en 14 clusters: Educación, Salud, Corrupción, Medio Ambiente, Servicios Públicos, Ideología, Economía, Empleo, Juventud, Justícia, Social, Terrorismo, Vivienda, Seguridad Ciudadana y Otros. 
			<br><br> A partir de estos nuevos clusters agruparemos los datos y obtendremos la información necesaria para los gráficos.</p>
			<h3><br> Congreso de los Diputados </h3>
			<p> Nos interesan los datos desde septiembre de 2000 a marzo de 2015, por correspondencia de los datos que tenemos del CIS. 
			<br><br>Las paginas web del Congreso se generan dinámicamente. Para obtener el listado y la descarga de los documentos de los diarios de sesiones utilizamos las herramientas de las librerias Selenium y BeautifulSoap.
			<br><br> Una vez obtenidos los documentos de los diarios de sesiones procedemos al análisis de la estructura de los textos para diseñar un proceso que nos permita extraer la información deseada. El contenido de los diarios de sesiones se estructura en forma de diálogos en torno a una pregunta o tema previamente registrado (todo tema tiene asociado un número de expediente que la identifica) por lo que cada intervención queda registrada literalmente indicándose al inicio quien la realizó. Sabiendo esto los documentos quedarán divididos en preguntas y respuestas realizadas en la sesión de control, los miembros y los grupos parlamentarios que las realizaron. 
			<p><br> Para identificar a los miembros del Congreso en sus intervenciones y grupos parlamentarios a los que pertenecen obtenemos la información de otro apartado de la web del congreso: <a href="http://www.congreso.es/portal/page/portal/Congreso/Congreso/Diputados?_piref73_1333056_73_1333049_1333049.next_page=/wc/menuAbecedarioInicio&tipoBusqueda=completo&idLegislatura=10"> Diputados </a></p>
			<img src="images/congres2.png" alt="Lista Diputados" width="700" height="700">
			<p> <br> Recurriremos nuevamente a Selenium y BeautifulSoap para obtener una relación de diputados, grupos parlamentarios y legislaturas del periodo analizado. Nuevamente esta información se guarda en MongoDB para su para usarla posteriormente en el proceso de extraccion de preguntas e intervenciones. 	</p>
			<h4> <br> Extracción de preguntas e intervenciones </h4>
			<p> Para la extracción de preguntas e intervenciones utilizamos expresiones regulares. Con ellas analizamos línea a línea el contenido de un diario buscando inicios o finales de preguntas e intervenciones, diputados, grupos parlamentarios...
			<br><br> El proceso empieza cuando encuentra las marcas que indican el inicio de los textos de preguntas, omitiendo secciones del diario que no se correspondan con las preguntas de la sesión de control, como por ejemplo: "PROPOSICIONES NO DE LEY", "CONVALIDACIÓN O DEROGACIÓN DE REALES DECRETOS-LEYES", "JURAMENTO O PROMESA DE ACATAMIENTO DE LA CONSTITUCIÓN", etc. También se omiten en el proceso de extracción las intervenciones realizadas por el moderador de la cámara.
			<br><br> A continuación se muestran un ejemplo en el que se ve el texto original y despues del proceso de análisis (con un fondo distinto en función del grupo político al que pertenece el diputado que realiza la intervención: azul, grupo popular; rojo, grupo socialista; gris, grupo mixto, ...):</p>
			<img src="images/intervencion1.png" alt="Intervención Congreso" width="900" height="600">
			<p> Utilizamos el método <a href="http://en.wikipedia.org/wiki/String_metric">String Metrics</a>, en el proceso de análisis para detectar posibles errores de transcripción en los diarios de sesiones. 
			<br><br> A continuación puedes ver como queda un diario de sesiones después de todo el proceso.  Si pasamos el cursor sobre las intervenciones nos da información sobre el interlocutor, grupo político y demás información obtenida durante el análisis.</p>
			<p><iframe src="images/diario.html" frameborder="0" id="borde"></iframe></p>
			
			</div>	 
			
		<div class="blog-post">
            <h2 class="blog-post-title">¿Cómo se obtienen las palabras clave de cada intervención?</h2>

            <p><br> En la base de datos del Congreso encontramos 311 documentos y 7000 intervenciones, etiquetar esto dentro de los clusters del CIS es un trabajo titánico así que trazamos un plan: extraeriamos las palabras clave de cada intervención y creariamos un diccionario "clasificador" que se iría nutriendo de las palabras clave que fuéramos encontrando con el objetivo de clusterizar el máximo de documentos.
			<br><br> Definimos como palabra clave o key word cualquier n-grama de palabras (secuencia de una o mas palabras) dentro del documento. Nos dimos cuenta que, en general, estos n-gramas estan compuestos por nombres y adjetivos, así que  nos centramos en estos dentro de nuestros documentos. 
			<br><br> Para encontrar estas palabras clave utilizamos RAKE (Rapid Automatic Keyword Extraction), un sencillo paquete de Python que utiliza solo un parámetro: una stop-list (o palabras a descartar), en nuestro caso consiste en cualquier palabra que no sea un nombre o un adjetivo. A partir de esto, RAKE generará un grafo de concurrencia de posibles palabras clave. Además, obtenemos una puntuación para cada una de ellas que consiste: grado(pc)/frec(pc).
			<br><br> Una vez finalizado este proceso construimos una matriz de frecuencia de los terminos utilizando las palabras clave como vocabulario (bag of the words) y mediante la librería scikit-learn transformar esta matriz en una matriz de dispersión. A continuación aplicamos un algoritmo K-means utilizando "k-means++" para crear los clusters. 
			<br><br> Seguidamente, después de varias iteraciones del K-means conseguimos distinguir una série de clusters que son claramente afines a los clusters del CIS. A partir de aquí cremaos un clasificador simple, y lo entrenamos para clasificar el resto de documentos. 
			<br><br> Finalmente, después de haber etiquetado los documentos utilizamos el número de líneas de cada intervención como medida de tiempo. Obtendremos una série de tablas y diccionarios que se utilizan mas adelante para la realización de los gráficos.</p>
			
		 </div><!-- /.blog-post -->	
		  
		<div class="blog-post">
            <h2 class="blog-post-title">Los Gráficos</h2>

            <p><br> Empezamos queriendo imitar a USA, nos encantaba este <a href="http://www.nytimes.com/interactive/2012/09/06/us/politics/convention-word-counts.html">gráfico</a> del NY Times, así que no podía faltar en nuestra presentación final, pero también eramos conscientes de que no cumpliriamos uno de nuestros objetivos principales: explotar la información del CIS.
			<br><br> Con este objetivo en mente surgieron los gráficos del radar y las diferencias, fantásticos ambos para ver como han ido cambiando nuestras preocupaciones a lo largo del tiempo. Para ello utilizamos el programa D3 y pasamos de gráficos estáticos a dinámicos creando transiciones para ayudar a la visualización. 
			<br><br> Cuando estabamos a punto de finalizar este proyecto, nos encontramos con el increíble gráfico <a href="http://politilines.periscopic.com/">PolitiLines</a>, teniamos toda la información: los clusters, las keywords, los partidos políticos que habian hablado sobre cada tema así que decidimos crear una versión española de este. </p>
          </div><!-- /.blog-post -->	  
			
			
			
        </div><!-- /.blog-main -->

    </div><!-- /.container -->

    <footer class="blog-footer">
      <p>Blog template built for <a href="http://getbootstrap.com">Bootstrap</a> by <a href="https://twitter.com/mdo">@mdo</a>.</p>
      <p>
        <a href="#">Back to top</a>
      </p>
    </footer>


    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <script src="bootstrap/js/bootstrap.min.js"></script>
  

</body></html>